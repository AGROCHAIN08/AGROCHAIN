<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Farmer Dashboard</title>
  <link rel="stylesheet" href="../assets/css/farmer.css">
  <style>
    @media print {
      body * {
        visibility: hidden;
      }
      #farmerReceiptContent, #farmerReceiptContent * {
        visibility: visible;
      }
      #farmerReceiptContent {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
      .modal-content button {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>👨‍🌾 Farmer Panel</h2>
    <button id="inventoryBtn">Inventory</button>
    <button id="ordersBtn">Orders</button>
    <button id="profileBtn">Profile</button>
    <button id="signoutBtn">Sign Out</button>
  </div>

  <!-- Main Content -->
  <div class="content">

    <!-- Inventory Section -->
    <section id="inventorySection">
      <h2>🌾 My Inventory</h2>
      <button class="add-btn" id="addCropToggleBtn">Add New Product</button>

      <form id="cropForm" style="display:none;" enctype="multipart/form-data">
        <div class="form-row">
          <label>Product Type: 
            <select id="productType" required>
              <option value="">Select Product Type</option>
              <option value="Fruit">Fruit</option>
              <option value="Vegetable">Vegetable</option>
              <option value="Cereal">Cereal</option>
              <option value="Spices">Spices</option>
              <option value="Pulses">Pulses</option>
              <option value="Oil Seeds">Oil Seeds</option>
              <option value="Other">Other</option>
            </select>
          </label>
        </div>

        <div class="form-row">
          <label>Variety/Species: <input type="text" id="varietySpecies" placeholder="e.g., Alphonso Mango, Red Delicious Apple" required></label>
        </div>

        <div class="form-row">
          <label>Harvest Quantity: <input type="number" id="harvestQuantity" step="0.01" required></label>
          <label>Unit of Sale: 
            <select id="unitOfSale" required>
              <option value="">Select Unit</option>
              <option value="Kg">Kg</option>
              <option value="Box (20 Kg)">Box (20 Kg)</option>
              <option value="Crate">Crate</option>
              <option value="Quintal">Quintal</option>
              <option value="Ton">Ton</option>
            </select>
          </label>
        </div>

        <div class="form-row">
          <label>
            Target Price (₹):
            <div style="display: flex; align-items: center; gap: 5px;">
              <input type="number" id="targetPrice" step="0.01" required>
              <span id="priceUnitLabel" style="font-weight: 500; color: #555;"></span>
            </div>
          </label>
        </div>

        <div class="form-row">
          <label>Upload Product Image: <input type="file" id="image" accept="image/*" required></label>
        </div>

        <button type="submit" class="submit-btn">Save Product</button>
      </form>

      <p id="cropError" style="color:red;"></p>
      <p id="successMsg" class="message"></p>

      <div id="productsGrid" class="products-grid"></div>
    </section>

    <!-- Orders Section -->
    <section id="ordersSection" style="display:none;">
      <h2>📦 My Orders</h2>
      
      <!-- Notifications Panel -->
      <div class="notifications-panel">
        <h3>🔔 Recent Notifications</h3>
        <div id="notificationsList"></div>
      </div>

      <!-- Orders Grid -->
      <div id="farmerOrdersGrid" class="orders-grid"></div>
    </section>

    <!-- Profile Section -->
    <section id="profileSection" style="display:none;">
      <h2>👤 My Profile</h2>
      <div id="profileInfo"></div>

      <!-- Editable Fields -->
      <form id="editProfileForm" style="display:none; margin-top: 20px;">
        <h3>Edit Additional Details</h3>

        <label>Farm Location</label>
        <input type="text" id="editFarmLocation" placeholder="Enter farm location">

        <label>Latitude</label>
        <input type="text" id="editLatitude" readonly>

        <label>Longitude</label>
        <input type="text" id="editLongitude" readonly>

        <button type="button" id="getGeoBtn">📍 Get Current Location</button>

        <label>Farm Size</label>
        <input type="text" id="editFarmSize" placeholder="Enter farm size (e.g. 5 acres)">

        <div style="margin-top: 10px;">
          <button type="submit" id="saveProfileBtn">💾 Save Changes</button>
          <button type="button" id="cancelEditBtn">✖ Cancel</button>
        </div>
      </form>
    </section>

  </div>

  <!-- Farmer Receipt Modal -->
  <div id="farmerReceiptModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
      <span class="close" onclick="closeFarmerReceiptModal()">&times;</span>
      <div id="farmerReceiptContent"></div>
      <div style="text-align: center; margin-top: 20px;">
        <button class="btn-primary" onclick="printFarmerReceipt()">🖨️ Print Receipt</button>
        <button class="btn-secondary" onclick="closeFarmerReceiptModal()" style="margin-left: 10px;">Close</button>
      </div>
    </div>
  </div>

  <script src="../assets/js/farmer.js"></script>
</body>
</html>